{% extends "shop/index.html" %}
{% load static %}

{% block content %}
    <div class="container mt-4">
        <!-- Kopfbereich der Bestellung -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="shadow p-3 mb-4">
                    <div class="d-flex justify-content-between">
                        <h3 class="fw-bold">Bestellübersicht</h3>
                        <a href="{% url 'complaint_form' order_id=order.order_id %}" class="btn btn-danger">Reklamieren</a>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Auftragsnummer:</strong> {{ order.order_id }}</p>
                            <p><strong>Käufer:</strong> {{ order.customer }}</p>
                            <p><strong>Bestelldatum:</strong> {{ order.created_at }}</p>
                            <u><h3 class="mt-4" style="color: #2d6a4f"><strong>Gesamtpreis:</strong> {{ order.get_cart_total|floatformat:2 }} €</h3></u>
                        </div>
                        <div class="col-md-6">
                            <p><strong>Bestellstatus:</strong> {{ order.status }}</p>
                            <p><strong>Tracking-ID:</strong> {{ order.tracking_number }}</p>
                            <p><strong>Versanddienstleister:</strong> {{ order.shipping_provider }}</p>
                            <p><strong>Lieferadresse:</strong></p>
                            <p>
                                {% with address=order.address_set.first %}
                                    {% if address %}
                                        {{ address.address }}<br>{{ address.zipcode }}<br>{{ address.city }}<br>{{ address.country }}
                                    {% else %}
                                        Keine Adresse vorhanden
                                    {% endif %}
                                {% endwith %}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bestellpositionen -->
        <div class="row">
            <div class="col-12">
                <div class="shadow p-3">
                    <h4 class="fw-bold mb-3">Bestellpositionen</h4>
                    <table class="table table-striped table-hover">
                        <thead>
                          <tr>
                            <th scope="col">Position</th>
                            <th scope="col">Bild</th>
                            <th scope="col">Artikel</th>
                            <th scope="col">Menge</th>
                            <th scope="col">Preis</th>
                            <th scope="col">Summe</th>
                          </tr>
                        </thead>
                        <tbody class="table-group-divider">
                          {% for article in articles %}
                          <tr>
                            <th scope="row">{{ forloop.counter }}</th>
                            <td><img src="{{ article.article.img.url }}" width="50" height="50" alt="{{ article.article.name }}"></td>
                            <td>{{ article.article.name }}</td>
                            <td>{{ article.quantity }}</td>
                            <td>{{ article.article.price|floatformat:2 }} €</td>
                            <td>{{ article.get_total|floatformat:2 }} €</td>
                          </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
